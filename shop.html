<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Shop ‚Äî Northborne O Sabah</title>
    <meta name="description" content="Buy produce and products from Northborne O Sabah" />
    <style>
      body{font-family:Inter,system-ui,Segoe UI,Roboto,Arial;margin:0;background:linear-gradient(135deg,#f3f7f6,#e6eef0);color:#0f1724;background-attachment:fixed}
      body::before{content:'';position:fixed;inset:0;background-image:radial-gradient(rgba(11,102,35,0.03) 1px, transparent 1px);background-size:26px 26px;opacity:0.9;pointer-events:none}
      .container{max-width:1000px;margin:32px auto;padding:20px;position:relative}
      header{display:flex;align-items:center;justify-content:space-between}
      .products{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px;margin-top:18px}
      .card{background:#fff;padding:14px;border-radius:12px;box-shadow:0 8px 24px rgba(2,6,23,0.06)}
      .card h3{margin:0 0 8px}
      .price{font-weight:700;color:#0b6623}
      .actions{display:flex;gap:8px;margin-top:12px}
      .btn{background:#0b6623;color:#fff;padding:8px 10px;border-radius:8px;border:0;cursor:pointer}
      .btn.secondary{background:#e6edf0;color:#0b1724}
      .cart{position:fixed;right:18px;top:18px;width:300px;background:#fff;padding:12px;border-radius:10px;box-shadow:0 12px 40px rgba(2,6,23,0.08)}
      /* Modern sided-box with frame */
      .sidebox{background:linear-gradient(135deg,#fff 0%,#fbfefb 100%);padding:14px;border-radius:12px;border:1.5px solid rgba(11,102,35,0.12);box-shadow:0 10px 30px rgba(11,102,35,0.08);transition:all 0.3s;opacity:0.3}
      .sidebox:hover{opacity:0.95;transform:translateY(-2px);box-shadow:0 15px 40px rgba(11,102,35,0.12)}
      .sidebox h4{margin:0 0 10px;color:#0b6623;font-size:0.95rem;text-transform:uppercase;letter-spacing:0.5px}
      .sidebox a{display:block;color:#0b6623;text-decoration:none;margin:6px 0;font-size:0.9rem;transition:color 0.2s}
      .sidebox a:hover{color:#154d2e;font-weight:500}
      @media(max-width:900px){.sidebox{position:static;width:auto;margin:12px 0;opacity:0.5}}
      /* Social buttons */
      .social-links{display:flex;gap:10px;margin-top:12px;justify-content:center}
      .social-btn{width:40px;height:40px;border-radius:8px;border:1px solid rgba(11,102,35,0.2);background:#fff;color:#0b6623;text-decoration:none;display:flex;align-items:center;justify-content:center;transition:all 0.2s;font-size:18px;font-weight:600}
      .social-btn:hover{background:#0b6623;color:#fff;transform:translateY(-2px)}
      .cart h4{margin:0 0 8px}
      .muted{color:#6b7280;font-size:0.95rem}
      /* Glasmorphism Effects */
      .sidebox, .card, .product-item, .section{background:rgba(255,255,255,0.75) !important;backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px);border:1px solid rgba(255,255,255,0.2)}
      /* Scroll Animation Keyframes */
      @keyframes fadeInUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
      .product-item, .card, .section{opacity:0;transition:opacity 0.6s ease, transform 0.6s ease, box-shadow 0.3s ease}
      .product-item.animate-in, .card.animate-in, .section.animate-in{animation:fadeInUp 0.6s ease forwards;opacity:1;transform:translateY(0)}
      a:hover, button:hover{transition:all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1)}
      @media(max-width:900px){.cart{position:static;margin-top:16px;width:auto}}
    </style>
    <link rel="stylesheet" href="chat-style.css">
    <script defer src="chat-widget.js"></script>
    <link rel="stylesheet" href="music-style.css">
    <script defer src="music-widget.js"></script>
  </head>
  <body>
    <div class="container">
      <header>
        <div>
          <h1>Shop ‚Äî Northborne O Sabah</h1>
          <div class="muted">Fresh produce and community products</div>
        </div>
        <div><a href="index.html">‚Üê Back</a></div>
      </header>

      <aside class="sidebox" aria-label="Related">
        <h4>Related</h4>
        <a href="index.html">Home</a>
        <a href="about.html">About</a>
        <a href="agriculture.html">Agriculture</a>
        <a href="finance.html">Finance</a>
        <a href="register.html">Register</a>
        <a href="#products">Products</a>
        <a href="mailto:info@northborneosabah.my">Contact</a>
      </aside>

      <main>
        <div class="products" id="products"></div>
      </main>

      <aside class="cart" id="cart">
        <h4>Your cart</h4>
        <div id="cartItems" class="muted">No items yet</div>
        <div style="margin-top:12px;display:flex;gap:8px">
          <button id="clearBtn" class="btn secondary">Clear</button>
          <button id="checkoutBtn" class="btn">Checkout</button>
        </div>
        <div style="margin-top:10px;color:#6b7280;font-size:0.95rem">Checkout powered by Stripe (sample)</div>
      </aside>
    </div>

    <footer style="text-align:center;margin-top:24px;padding-top:12px;border-top:1px solid #eef2ee">
      <div class="muted" style="font-size:0.9rem;margin-bottom:8px">Follow us on social media:</div>
      <div class="social-links">
        <a class="social-btn" href="https://facebook.com" title="Facebook" target="_blank">f</a>
        <a class="social-btn" href="https://twitter.com" title="Twitter" target="_blank">ùïè</a>
        <a class="social-btn" href="https://instagram.com" title="Instagram" target="_blank">üì∑</a>
        <a class="social-btn" href="https://linkedin.com" title="LinkedIn" target="_blank">in</a>
        <a class="social-btn" href="https://wa.me/" title="WhatsApp" target="_blank">üí¨</a>
      </div>
      <div style="margin-top:8px;color:#6b7280;font-size:0.85rem">¬© <span id="year"></span> Northborne O Sabah</div>
    </footer>

    <script>
      document.getElementById('year').textContent = new Date().getFullYear();
      // Simple product catalog (id, name, price in cents, currency)
      const PRODUCTS = [
        {id:'apple',name:'Sabah Organic Apple (1 kg)',price:1200,currency:'myr'},
        {id:'honey',name:'Local Wild Honey (250g)',price:4500,currency:'myr'},
        {id:'spice',name:'Traditional Spice Mix (100g)',price:1500,currency:'myr'}
      ];

      const productsEl = document.getElementById('products');
      const cartItemsEl = document.getElementById('cartItems');
      const checkoutBtn = document.getElementById('checkoutBtn');
      const clearBtn = document.getElementById('clearBtn');

      let cart = {};

      function formatPrice(cents, currency='MYR'){
        return (cents/100).toFixed(2) + ' ' + currency.toUpperCase();
      }

      function renderProducts(){
        productsEl.innerHTML = PRODUCTS.map(p=>`
          <div class="card">
            <h3>${p.name}</h3>
            <div class="price">${formatPrice(p.price,p.currency)}</div>
            <div class="actions">
              <button class="btn" onclick="addToCart('${p.id}')">Add</button>
            </div>
          </div>
        `).join('');
      }

      function renderCart(){
        const items = Object.keys(cart);
        if(items.length===0){ cartItemsEl.textContent='No items yet'; return; }
        const rows = items.map(id=>{
          const p = PRODUCTS.find(x=>x.id===id);
          const qty = cart[id];
          return `<div style="margin-bottom:8px"><strong>${p.name}</strong> ‚Äî ${qty} √ó ${formatPrice(p.price,p.currency)}</div>`;
        });
        const total = items.reduce((s,id)=> s + PRODUCTS.find(x=>x.id===id).price * cart[id],0);
        rows.push(`<div style="margin-top:8px;font-weight:700">Total: ${formatPrice(total,'MYR')}</div>`);
        cartItemsEl.innerHTML = rows.join('');
      }

      function addToCart(id){ cart[id] = (cart[id]||0)+1; renderCart(); }
      function clearCart(){ cart = {}; renderCart(); }
      clearBtn.addEventListener('click', clearCart);

      checkoutBtn.addEventListener('click', async ()=>{
        const items = Object.keys(cart).map(id => ({id,quantity:cart[id]}));
        if(items.length===0){ alert('Your cart is empty'); return; }

        // Send cart to sample server to create a Stripe Checkout Session
        try{
          const res = await fetch('http://localhost:4242/create-checkout-session',{
            method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({items})
          });
          const data = await res.json();
          if(data.url){ window.location = data.url; }
          else alert('Failed to create checkout session');
        }catch(err){ alert('Could not contact server. See README for setup.'); }
      });

      renderProducts(); renderCart();
    </script>
    <script src="scroll-animations.js"></script>
  </body>
</html>
